--================================================================================================================
--=================================== 2025.01.23 =================================================================
--================================================================================================================



-- Table: public.tbl_user

-- DROP TABLE IF EXISTS public.tbl_user;

CREATE TABLE IF NOT EXISTS public.tbl_user
(
    user_id bigint NOT NULL,
    user_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    external_user_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    full_name character varying(255) COLLATE pg_catalog."default",
    email character varying(255) COLLATE pg_catalog."default",
    notes character varying(2000) COLLATE pg_catalog."default",
    total_jobs integer NOT NULL,
    total_pages integer NOT NULL,
    total_sheets integer NOT NULL,
    reset_by character varying(255) COLLATE pg_catalog."default",
    reset_date timestamp without time zone,
    deleted character(1) COLLATE pg_catalog."default" NOT NULL,
    deleted_date timestamp without time zone,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    department character varying(200) COLLATE pg_catalog."default",
    office character varying(200) COLLATE pg_catalog."default",
    card_number character varying(100) COLLATE pg_catalog."default",
    disabled_printing character(1) COLLATE pg_catalog."default" NOT NULL,
    disabled_printing_until timestamp without time zone,
    net_reset_by character varying(255) COLLATE pg_catalog."default",
    net_reset_date timestamp without time zone,
    net_total_megabytes double precision NOT NULL,
    net_total_time_hours double precision NOT NULL,
    disabled_net character(1) COLLATE pg_catalog."default" NOT NULL,
    disabled_net_until timestamp without time zone,
    internal character(1) COLLATE pg_catalog."default" NOT NULL,
    last_user_activity timestamp without time zone,
    card_number2 character varying(100) COLLATE pg_catalog."default",
    secondary_user_name character varying(255) COLLATE pg_catalog."default",
    modified_ticks bigint NOT NULL,
    home_directory character varying(255) COLLATE pg_catalog."default",
    primary_user_source_type character varying(30) COLLATE pg_catalog."default",
    secondary_user_source_type character varying(30) COLLATE pg_catalog."default",
    secondary_external_user_name character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT tbl_user_pkey PRIMARY KEY (user_id)
)

TABLESPACE pg_default;

-- Index: idx_external_user_name

-- DROP INDEX IF EXISTS public.idx_external_user_name;

CREATE INDEX IF NOT EXISTS idx_external_user_name
    ON public.tbl_user USING btree
    (external_user_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: idx_sec_external_user_name

-- DROP INDEX IF EXISTS public.idx_sec_external_user_name;

CREATE INDEX IF NOT EXISTS idx_sec_external_user_name
    ON public.tbl_user USING btree
    (secondary_external_user_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_card_number

-- DROP INDEX IF EXISTS public.ix_user_card_number;

CREATE INDEX IF NOT EXISTS ix_user_card_number
    ON public.tbl_user USING btree
    (card_number COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_card_number2

-- DROP INDEX IF EXISTS public.ix_user_card_number2;

CREATE INDEX IF NOT EXISTS ix_user_card_number2
    ON public.tbl_user USING btree
    (card_number2 COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_email

-- DROP INDEX IF EXISTS public.ix_user_email;

CREATE INDEX IF NOT EXISTS ix_user_email
    ON public.tbl_user USING btree
    (email COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_modified

-- DROP INDEX IF EXISTS public.ix_user_modified;

CREATE INDEX IF NOT EXISTS ix_user_modified
    ON public.tbl_user USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_secondary_user_name

-- DROP INDEX IF EXISTS public.ix_user_secondary_user_name;

CREATE INDEX IF NOT EXISTS ix_user_secondary_user_name
    ON public.tbl_user USING btree
    (secondary_user_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_user_name

-- DROP INDEX IF EXISTS public.ix_user_user_name;

CREATE INDEX IF NOT EXISTS ix_user_user_name
    ON public.tbl_user USING btree
    (user_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;




-- Table: public.tbl_user_attribute

-- DROP TABLE IF EXISTS public.tbl_user_attribute;

CREATE TABLE IF NOT EXISTS public.tbl_user_attribute
(
    user_id bigint NOT NULL,
    attrib_value character varying(1000) COLLATE pg_catalog."default",
    modified_ticks bigint NOT NULL,
    propagate character(1) COLLATE pg_catalog."default" NOT NULL,
    attrib_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_user_attribute_pkey PRIMARY KEY (user_id, attrib_name),
    CONSTRAINT fk_user_attribute FOREIGN KEY (user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- Index: ix_user_attribute_modified

-- DROP INDEX IF EXISTS public.ix_user_attribute_modified;

CREATE INDEX IF NOT EXISTS ix_user_attribute_modified
    ON public.tbl_user_attribute USING btree
    (modified_ticks ASC NULLS LAST, propagate COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;




-- Table: public.tbl_group

-- DROP TABLE IF EXISTS public.tbl_group;

CREATE TABLE IF NOT EXISTS public.tbl_group
(
    group_id bigint NOT NULL,
    group_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    initial_credit double precision NOT NULL,
    initially_restricted character(1) COLLATE pg_catalog."default" NOT NULL,
    schedule_period character varying(10) COLLATE pg_catalog."default" NOT NULL,
    schedule_amount double precision NOT NULL,
    allow_accum character(1) COLLATE pg_catalog."default" NOT NULL,
    max_accum_balance double precision NOT NULL,
    reset_statistics character(1) COLLATE pg_catalog."default" NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    initial_settings_enabled character(1) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    CONSTRAINT tbl_group_pkey PRIMARY KEY (group_id),
    CONSTRAINT tbl_group_group_name_key UNIQUE (group_name)
)

TABLESPACE pg_default;

-- Index: ix_group_modified

-- DROP INDEX IF EXISTS public.ix_group_modified;

CREATE INDEX IF NOT EXISTS ix_group_modified
    ON public.tbl_group USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_group_name

-- DROP INDEX IF EXISTS public.ix_group_name;

CREATE INDEX IF NOT EXISTS ix_group_name
    ON public.tbl_group USING btree
    (group_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;




-- Table: public.tbl_group_attribute

-- DROP TABLE IF EXISTS public.tbl_group_attribute;

CREATE TABLE IF NOT EXISTS public.tbl_group_attribute
(
    group_id bigint NOT NULL,
    attrib_value character varying(255) COLLATE pg_catalog."default",
    modified_ticks bigint NOT NULL,
    propagate character(1) COLLATE pg_catalog."default" NOT NULL,
    attrib_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_group_attribute_pkey PRIMARY KEY (group_id, attrib_name),
    CONSTRAINT fk_group_attribute FOREIGN KEY (group_id)
        REFERENCES public.tbl_group (group_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- Index: ix_group_attribute_modified

-- DROP INDEX IF EXISTS public.ix_group_attribute_modified;

CREATE INDEX IF NOT EXISTS ix_group_attribute_modified
    ON public.tbl_group_attribute USING btree
    (modified_ticks ASC NULLS LAST, propagate COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;




-- Table: public.tbl_printer

-- DROP TABLE IF EXISTS public.tbl_printer;

CREATE TABLE IF NOT EXISTS public.tbl_printer
(
    printer_id bigint NOT NULL,
    server_name character varying(255) COLLATE pg_catalog."default",
    printer_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    display_name character varying(510) COLLATE pg_catalog."default" NOT NULL,
    location character varying(255) COLLATE pg_catalog."default",
    notes character varying(2000) COLLATE pg_catalog."default",
    charge_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    default_cost double precision NOT NULL,
    deleted character(1) COLLATE pg_catalog."default" NOT NULL,
    deleted_date timestamp without time zone,
    disabled character(1) COLLATE pg_catalog."default" NOT NULL,
    disabled_until timestamp without time zone,
    total_jobs integer NOT NULL,
    total_pages integer NOT NULL,
    total_sheets integer NOT NULL,
    reset_by character varying(255) COLLATE pg_catalog."default",
    reset_date timestamp without time zone,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    color_detection_mode character varying(20) COLLATE pg_catalog."default" NOT NULL,
    device_type character varying(100) COLLATE pg_catalog."default" NOT NULL,
    ext_device_function character varying(30) COLLATE pg_catalog."default",
    physical_printer_id character varying(100) COLLATE pg_catalog."default",
    printer_type character varying(200) COLLATE pg_catalog."default",
    serial_number character varying(100) COLLATE pg_catalog."default",
    web_print_enabled character(1) COLLATE pg_catalog."default" NOT NULL,
    custom1 character varying(50) COLLATE pg_catalog."default",
    custom2 character varying(50) COLLATE pg_catalog."default",
    custom3 character varying(50) COLLATE pg_catalog."default",
    custom4 character varying(50) COLLATE pg_catalog."default",
    custom5 character varying(50) COLLATE pg_catalog."default",
    custom6 character varying(50) COLLATE pg_catalog."default",
    last_usage_date timestamp without time zone,
    gcp_printer_id character varying(100) COLLATE pg_catalog."default",
    gcp_enabled character(1) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    server_uuid character varying(255) COLLATE pg_catalog."default",
    parent_id bigint,
    CONSTRAINT tbl_printer_pkey PRIMARY KEY (printer_id),
    CONSTRAINT fk_printer_parent_printer FOREIGN KEY (parent_id)
        REFERENCES public.tbl_printer (printer_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- Index: ix_gcp_printer_id

-- DROP INDEX IF EXISTS public.ix_gcp_printer_id;

CREATE INDEX IF NOT EXISTS ix_gcp_printer_id
    ON public.tbl_printer USING btree
    (gcp_printer_id COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_modified

-- DROP INDEX IF EXISTS public.ix_printer_modified;

CREATE INDEX IF NOT EXISTS ix_printer_modified
    ON public.tbl_printer USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_physical_id

-- DROP INDEX IF EXISTS public.ix_printer_physical_id;

CREATE INDEX IF NOT EXISTS ix_printer_physical_id
    ON public.tbl_printer USING btree
    (physical_printer_id COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_server_printer

-- DROP INDEX IF EXISTS public.ix_printer_server_printer;

CREATE INDEX IF NOT EXISTS ix_printer_server_printer
    ON public.tbl_printer USING btree
    (server_name COLLATE pg_catalog."default" ASC NULLS LAST, printer_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;




-- Table: public.tbl_printer_attribute

-- DROP TABLE IF EXISTS public.tbl_printer_attribute;

CREATE TABLE IF NOT EXISTS public.tbl_printer_attribute
(
    printer_id bigint NOT NULL,
    attrib_value character varying(1000) COLLATE pg_catalog."default",
    modified_ticks bigint NOT NULL,
    propagate character(1) COLLATE pg_catalog."default" NOT NULL,
    attrib_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_printer_attribute_pkey PRIMARY KEY (printer_id, attrib_name),
    CONSTRAINT fk_printer_attribute FOREIGN KEY (printer_id)
        REFERENCES public.tbl_printer (printer_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- Index: ix_printer_attribute_modified

-- DROP INDEX IF EXISTS public.ix_printer_attribute_modified;

CREATE INDEX IF NOT EXISTS ix_printer_attribute_modified
    ON public.tbl_printer_attribute USING btree
    (modified_ticks ASC NULLS LAST, propagate COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;

--================================================================================================================
--=================================== 2025.01.21 =================================================================
--================================================================================================================


CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Table: public.tbl_account

-- DROP TABLE IF EXISTS public.tbl_account;

CREATE TABLE IF NOT EXISTS public.tbl_account
(
    account_id bigint NOT NULL,
    account_type character varying(10) COLLATE pg_catalog."default" NOT NULL,
    account_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    balance double precision NOT NULL,
    restricted character(1) COLLATE pg_catalog."default" NOT NULL,
    overdraft double precision NOT NULL,
    pin character varying(50) COLLATE pg_catalog."default",
    use_global_overdraft character(1) COLLATE pg_catalog."default" NOT NULL,
    notes character varying(2000) COLLATE pg_catalog."default",
    deleted character(1) COLLATE pg_catalog."default" NOT NULL,
    deleted_date timestamp without time zone,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    parent_id bigint,
    account_name_lower character varying(255) COLLATE pg_catalog."default" NOT NULL,
    sub_name character varying(255) COLLATE pg_catalog."default",
    sub_name_lower character varying(255) COLLATE pg_catalog."default",
    disabled character(1) COLLATE pg_catalog."default" NOT NULL,
    disabled_until timestamp without time zone,
    comments character varying(20) COLLATE pg_catalog."default" NOT NULL,
    invoicing character varying(20) COLLATE pg_catalog."default" NOT NULL,
    sub_pin character varying(50) COLLATE pg_catalog."default",
    modified_ticks bigint NOT NULL,
    CONSTRAINT tbl_account_pkey PRIMARY KEY (account_id),
    CONSTRAINT fk_account_parent_account FOREIGN KEY (parent_id)
        REFERENCES public.tbl_account (account_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_account_modified;

CREATE INDEX IF NOT EXISTS ix_account_modified
    ON public.tbl_account USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_account_name_type

-- DROP INDEX IF EXISTS public.ix_account_name_type;

CREATE INDEX IF NOT EXISTS ix_account_name_type
    ON public.tbl_account USING btree
    (account_type COLLATE pg_catalog."default" ASC NULLS LAST, account_name_lower COLLATE pg_catalog."default" ASC NULLS LAST, sub_name_lower COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_account_parent_account

-- DROP INDEX IF EXISTS public.ix_account_parent_account;

CREATE INDEX IF NOT EXISTS ix_account_parent_account
    ON public.tbl_account USING btree
    (parent_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_account_pin

-- DROP INDEX IF EXISTS public.ix_account_pin;

CREATE INDEX IF NOT EXISTS ix_account_pin
    ON public.tbl_account USING btree
    (pin COLLATE pg_catalog."default" ASC NULLS LAST, sub_pin COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;


 DROP TABLE IF EXISTS public.tbl_account_temp;

CREATE TABLE IF NOT EXISTS public.tbl_account_temp
(
    account_id              varchar(255),
    account_type            varchar(255),
    account_name            varchar(255),
    balance                 varchar(255),
    restricted              varchar(255),
    overdraft               varchar(255),
    pin                     varchar(255),
    use_global_overdraft    varchar(255),
    notes                   varchar(2000),
    deleted                 varchar(255),
    deleted_date            varchar(255),
    created_date            varchar(255),
    created_by              varchar(255),
    modified_date           varchar(255),
    modified_by             varchar(255),
    parent_id               varchar(255),
    account_name_lower      varchar(255),
    sub_name                varchar(255),
    sub_name_lower          varchar(255),
    disabled                varchar(255),
    disabled_until          varchar(255),
    comments                varchar(255),
    invoicing               varchar(255),
    sub_pin                 varchar(255),
    modified_ticks          varchar(255)
);

COPY tbl_account_temp (
 account_id         ,    
 account_type           ,
 account_name           ,
 balance                ,
 restricted             ,
 overdraft              ,
 pin                    ,
 use_global_overdraft   ,
 notes                  ,
 deleted                ,
 deleted_date           ,
 created_date          ,
 created_by             ,
 modified_date         ,
 modified_by            ,
 parent_id              ,
 account_name_lower     ,
 sub_name               ,
 sub_name_lower         ,
 disabled               ,
 disabled_until         ,
 comments               ,
 invoicing              ,
 sub_pin                ,
 modified_ticks         
) FROM 'c:\path_to_db\tbl_account_20250121.csv' csv HEADER;

INSERT INTO tbl_account (
	 account_id         ,    
 account_type           ,
 account_name           ,
 balance               ,
 restricted             ,
 overdraft             ,
 pin                    ,
 use_global_overdraft   ,
 notes                  ,
 deleted                ,
 deleted_date           ,
 created_date           ,
 created_by             ,
 modified_date          ,
 modified_by            ,
 parent_id              ,
 account_name_lower     ,
 sub_name               ,
 sub_name_lower         ,
 disabled               ,
 disabled_until         ,
 comments               ,
 invoicing              ,
 sub_pin                ,
 modified_ticks         
)
SELECT 
	 account_id  ::bigint       ,    
 account_type           ,
 account_name           ,
 balance           ::  double precision      ,
 restricted             ,
 overdraft          ::  double precision    ,
 pin                    ,
 use_global_overdraft   ,
 notes                  ,
 deleted                ,
 deleted_date       ::timestamp    ,
 created_date       ::timestamp    ,
 created_by             ,
 modified_date      ::timestamp    ,
 modified_by            ,
 parent_id           ::bigint   ,
 account_name_lower     ,
 sub_name               ,
 sub_name_lower         ,
 disabled               ,
 disabled_until      ::timestamp   ,
 comments               ,
 invoicing              ,
 sub_pin                ,
 modified_ticks      ::bigint   
FROM tbl_account_temp;

DROP TABLE IF EXISTS public.tbl_account_temp;

-- Table: public.tbl_account_attribute

-- DROP TABLE IF EXISTS public.tbl_account_attribute;

CREATE TABLE IF NOT EXISTS public.tbl_account_attribute
(
    account_id bigint NOT NULL,
    attrib_value character varying(255) COLLATE pg_catalog."default",
    modified_ticks bigint NOT NULL,
    propagate character(1) COLLATE pg_catalog."default" NOT NULL,
    attrib_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_account_attribute_pkey PRIMARY KEY (account_id, attrib_name),
    CONSTRAINT fk_account_attribute FOREIGN KEY (account_id)
        REFERENCES public.tbl_account (account_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_account_attribute_modified;

CREATE INDEX IF NOT EXISTS ix_account_attribute_modified
    ON public.tbl_account_attribute USING btree
    (modified_ticks ASC NULLS LAST, propagate COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;



-- Table: public.tbl_account_group

-- DROP TABLE IF EXISTS public.tbl_account_group;

CREATE TABLE IF NOT EXISTS public.tbl_account_group
(
    account_group_id bigint NOT NULL,
    group_id bigint NOT NULL,
    account_id bigint NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    CONSTRAINT tbl_account_group_pkey PRIMARY KEY (account_group_id),
    CONSTRAINT fk_account_group_account FOREIGN KEY (account_id)
        REFERENCES public.tbl_account (account_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_account_group_group FOREIGN KEY (group_id)
        REFERENCES public.tbl_group (group_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_account_group_account;

CREATE INDEX IF NOT EXISTS ix_account_group_account
    ON public.tbl_account_group USING btree
    (account_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_account_group_group

-- DROP INDEX IF EXISTS public.ix_account_group_group;

CREATE INDEX IF NOT EXISTS ix_account_group_group
    ON public.tbl_account_group USING btree
    (group_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_account_group_modified

-- DROP INDEX IF EXISTS public.ix_account_group_modified;

CREATE INDEX IF NOT EXISTS ix_account_group_modified
    ON public.tbl_account_group USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_account_transaction

-- DROP TABLE IF EXISTS public.tbl_account_transaction;

CREATE TABLE IF NOT EXISTS public.tbl_account_transaction
(
    account_transaction_id bigint NOT NULL,
    transaction_date timestamp without time zone NOT NULL,
    transacted_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    account_id bigint NOT NULL,
    usage_log_type character varying(20) COLLATE pg_catalog."default",
    usage_log_id bigint,
    amount double precision NOT NULL,
    balance double precision NOT NULL,
    txn_comment character varying(255) COLLATE pg_catalog."default",
    is_credit character(1) COLLATE pg_catalog."default" NOT NULL,
    transaction_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    ext_device_id bigint,
    CONSTRAINT tbl_account_transaction_pkey PRIMARY KEY (account_transaction_id),
    CONSTRAINT fk_account_ext_device FOREIGN KEY (ext_device_id)
        REFERENCES public.tbl_printer (printer_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_account_transaction_account FOREIGN KEY (account_id)
        REFERENCES public.tbl_account (account_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_account_ext_device;

CREATE INDEX IF NOT EXISTS ix_account_ext_device
    ON public.tbl_account_transaction USING btree
    (ext_device_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_account_transaction_account

-- DROP INDEX IF EXISTS public.ix_account_transaction_account;

CREATE INDEX IF NOT EXISTS ix_account_transaction_account
    ON public.tbl_account_transaction USING btree
    (account_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_account_transaction_date

-- DROP INDEX IF EXISTS public.ix_account_transaction_date;

CREATE INDEX IF NOT EXISTS ix_account_transaction_date
    ON public.tbl_account_transaction USING btree
    (transaction_date ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_account_transaction_usage

-- DROP INDEX IF EXISTS public.ix_account_transaction_usage;

CREATE INDEX IF NOT EXISTS ix_account_transaction_usage
    ON public.tbl_account_transaction USING btree
    (usage_log_type COLLATE pg_catalog."default" ASC NULLS LAST, usage_log_id ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_job_log_journal

-- DROP TABLE IF EXISTS public.tbl_job_log_journal;

CREATE TABLE IF NOT EXISTS public.tbl_job_log_journal
(
    log_id bigint NOT NULL,
    method_name character varying(128) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_job_log_journal_pkey PRIMARY KEY (log_id)
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_method_name;

CREATE INDEX IF NOT EXISTS ix_method_name
    ON public.tbl_job_log_journal USING btree
    (method_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_job_log_journal_payload

-- DROP TABLE IF EXISTS public.tbl_job_log_journal_payload;

CREATE TABLE IF NOT EXISTS public.tbl_job_log_journal_payload
(
    log_id bigint NOT NULL,
    segment integer NOT NULL,
    payload character varying(4000) COLLATE pg_catalog."default",
    CONSTRAINT tbl_job_log_journal_payload_pkey PRIMARY KEY (log_id, segment),
    CONSTRAINT fk_tbl_job_log_journal_payload FOREIGN KEY (log_id)
        REFERENCES public.tbl_job_log_journal (log_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- Table: public.tbl_user_email_address

-- DROP TABLE IF EXISTS public.tbl_user_email_address;

CREATE TABLE IF NOT EXISTS public.tbl_user_email_address
(
    user_email_address_id bigint NOT NULL,
    user_id bigint,
    email_address character varying(255) COLLATE pg_catalog."default" NOT NULL,
    email_status character varying(30) COLLATE pg_catalog."default" NOT NULL,
    verification_sent_time timestamp without time zone,
    verification_code character varying(20) COLLATE pg_catalog."default",
    CONSTRAINT tbl_user_email_address_pkey PRIMARY KEY (user_email_address_id),
    CONSTRAINT fk_user_id FOREIGN KEY (user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_email_verification_code;

CREATE INDEX IF NOT EXISTS ix_email_verification_code
    ON public.tbl_user_email_address USING btree
    (verification_code COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_email_address

-- DROP INDEX IF EXISTS public.ix_user_email_address;

CREATE INDEX IF NOT EXISTS ix_user_email_address
    ON public.tbl_user_email_address USING btree
    (email_address COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;

-- Table: public.tbl_user_field_history

-- DROP TABLE IF EXISTS public.tbl_user_field_history;

CREATE TABLE IF NOT EXISTS public.tbl_user_field_history
(
    user_field_history_id bigint NOT NULL,
    user_id bigint NOT NULL,
    field_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    field_value character varying(200) COLLATE pg_catalog."default",
    start_date timestamp without time zone NOT NULL,
    end_date timestamp without time zone NOT NULL,
    CONSTRAINT tbl_user_field_history_pkey PRIMARY KEY (user_field_history_id),
    CONSTRAINT fk_user_field_history_user FOREIGN KEY (user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_user_field_history;

CREATE INDEX IF NOT EXISTS ix_user_field_history
    ON public.tbl_user_field_history USING btree
    (user_id ASC NULLS LAST, field_type COLLATE pg_catalog."default" ASC NULLS LAST, field_value COLLATE pg_catalog."default" ASC NULLS LAST, start_date ASC NULLS LAST)
    TABLESPACE pg_default;

-- Table: public.tbl_user_group

-- DROP TABLE IF EXISTS public.tbl_user_group;

CREATE TABLE IF NOT EXISTS public.tbl_user_group
(
    user_group_id bigint NOT NULL,
    user_id bigint NOT NULL,
    group_id bigint NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    CONSTRAINT tbl_user_group_pkey PRIMARY KEY (user_group_id),
    CONSTRAINT fk_user_group_group FOREIGN KEY (group_id)
        REFERENCES public.tbl_group (group_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_user_group_user FOREIGN KEY (user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_user_group_group;

CREATE INDEX IF NOT EXISTS ix_user_group_group
    ON public.tbl_user_group USING btree
    (group_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_group_modified

-- DROP INDEX IF EXISTS public.ix_user_group_modified;

CREATE INDEX IF NOT EXISTS ix_user_group_modified
    ON public.tbl_user_group USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_group_user

-- DROP INDEX IF EXISTS public.ix_user_group_user;

CREATE INDEX IF NOT EXISTS ix_user_group_user
    ON public.tbl_user_group USING btree
    (user_id ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_audit_log

-- DROP TABLE IF EXISTS public.tbl_audit_log;

CREATE TABLE IF NOT EXISTS public.tbl_audit_log
(
    audit_log_id bigint NOT NULL,
    action character varying(20) COLLATE pg_catalog."default" NOT NULL,
    entity_type character varying(255) COLLATE pg_catalog."default" NOT NULL,
    entity_id bigint NOT NULL,
    entity_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    property_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    previous_value character varying(1000) COLLATE pg_catalog."default",
    modified_value character varying(1000) COLLATE pg_catalog."default",
    modified_by_id bigint NOT NULL,
    modified_by_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_audit_log_pkey PRIMARY KEY (audit_log_id)
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_audit_log_action;

CREATE INDEX IF NOT EXISTS ix_audit_log_action
    ON public.tbl_audit_log USING btree
    (action COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_audit_log_date

-- DROP INDEX IF EXISTS public.ix_audit_log_date;

CREATE INDEX IF NOT EXISTS ix_audit_log_date
    ON public.tbl_audit_log USING btree
    (modified_date ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_printer_group

-- DROP TABLE IF EXISTS public.tbl_printer_group;

CREATE TABLE IF NOT EXISTS public.tbl_printer_group
(
    printer_group_id bigint NOT NULL,
    group_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    display_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    CONSTRAINT tbl_printer_group_pkey PRIMARY KEY (printer_group_id),
    CONSTRAINT tbl_printer_group_display_name_key UNIQUE (display_name),
    CONSTRAINT tbl_printer_group_group_name_key UNIQUE (group_name)
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_printer_group_modified;

CREATE INDEX IF NOT EXISTS ix_printer_group_modified
    ON public.tbl_printer_group USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_group_name

-- DROP INDEX IF EXISTS public.ix_printer_group_name;

CREATE INDEX IF NOT EXISTS ix_printer_group_name
    ON public.tbl_printer_group USING btree
    (group_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_printer_printer_group

-- DROP TABLE IF EXISTS public.tbl_printer_printer_group;

CREATE TABLE IF NOT EXISTS public.tbl_printer_printer_group
(
    printer_id bigint NOT NULL,
    printer_group_id bigint NOT NULL,
    CONSTRAINT tbl_printer_printer_group_pkey PRIMARY KEY (printer_id, printer_group_id),
    CONSTRAINT fk_printer_printer_group_grp FOREIGN KEY (printer_group_id)
        REFERENCES public.tbl_printer_group (printer_group_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_printer_printer_group_prnt FOREIGN KEY (printer_id)
        REFERENCES public.tbl_printer (printer_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- Table: public.tbl_print_hardware_check

-- DROP TABLE IF EXISTS public.tbl_print_hardware_check;

CREATE TABLE IF NOT EXISTS public.tbl_print_hardware_check
(
    print_hardware_check_id bigint NOT NULL,
    check_date timestamp without time zone NOT NULL,
    status character varying(6) COLLATE pg_catalog."default" NOT NULL,
    check_method character varying(20) COLLATE pg_catalog."default" NOT NULL,
    check_message character varying(255) COLLATE pg_catalog."default",
    check_total_pages integer NOT NULL,
    check_color_pages integer NOT NULL,
    check_cost double precision NOT NULL,
    orig_total_pages integer NOT NULL,
    orig_color_pages integer NOT NULL,
    orig_color_pages_estimated character(1) COLLATE pg_catalog."default" NOT NULL,
    orig_cost double precision NOT NULL,
    adjustment_applied_date timestamp without time zone,
    adjustment_applied_by character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT tbl_print_hardware_check_pkey PRIMARY KEY (print_hardware_check_id)
)

TABLESPACE pg_default;

-- Table: public.tbl_refund_request

-- DROP TABLE IF EXISTS public.tbl_refund_request;

CREATE TABLE IF NOT EXISTS public.tbl_refund_request
(
    refund_request_id bigint NOT NULL,
    request_date timestamp without time zone NOT NULL,
    status character varying(6) COLLATE pg_catalog."default" NOT NULL,
    request_user_id bigint,
    request_reason character varying(1000) COLLATE pg_catalog."default",
    request_amount double precision NOT NULL,
    response_date timestamp without time zone,
    response_username character varying(255) COLLATE pg_catalog."default",
    response_reason character varying(1000) COLLATE pg_catalog."default",
    refunded_amount double precision,
    CONSTRAINT tbl_refund_request_pkey PRIMARY KEY (refund_request_id),
    CONSTRAINT fk_refund_request_user FOREIGN KEY (request_user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_refund_request_date;

CREATE INDEX IF NOT EXISTS ix_refund_request_date
    ON public.tbl_refund_request USING btree
    (request_date ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_refund_request_status

-- DROP INDEX IF EXISTS public.ix_refund_request_status;

CREATE INDEX IF NOT EXISTS ix_refund_request_status
    ON public.tbl_refund_request USING btree
    (status COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_refund_request_user

-- DROP INDEX IF EXISTS public.ix_refund_request_user;

CREATE INDEX IF NOT EXISTS ix_refund_request_user
    ON public.tbl_refund_request USING btree
    (request_user_id ASC NULLS LAST)
    TABLESPACE pg_default;

-- Table: public.tbl_printer_usage_log

-- DROP TABLE IF EXISTS public.tbl_printer_usage_log;

CREATE TABLE IF NOT EXISTS public.tbl_printer_usage_log
(
    printer_usage_log_id bigint NOT NULL,
    usage_date timestamp without time zone NOT NULL,
    usage_day timestamp without time zone NOT NULL,
    used_by_user_id bigint NOT NULL,
    charged_to_account_id bigint NOT NULL,
    usage_cost double precision NOT NULL,
    usage_allowed character(1) COLLATE pg_catalog."default" NOT NULL,
    printer_id bigint NOT NULL,
    original_printer_id bigint,
    job_id character varying(255) COLLATE pg_catalog."default",
    document_name character varying(255) COLLATE pg_catalog."default",
    client_machine character varying(255) COLLATE pg_catalog."default",
    total_pages integer NOT NULL,
    total_sheets integer NOT NULL,
    copies integer NOT NULL,
    paper_size character varying(20) COLLATE pg_catalog."default" NOT NULL,
    paper_height_mm integer NOT NULL,
    paper_width_mm integer NOT NULL,
    printer_language character varying(50) COLLATE pg_catalog."default",
    document_size_kb integer NOT NULL,
    denied_reason character varying(30) COLLATE pg_catalog."default",
    duplex character(1) COLLATE pg_catalog."default" NOT NULL,
    gray_scale character(1) COLLATE pg_catalog."default" NOT NULL,
    printed character(1) COLLATE pg_catalog."default" NOT NULL,
    cancelled character(1) COLLATE pg_catalog."default" NOT NULL,
    refunded character(1) COLLATE pg_catalog."default" NOT NULL,
    assoc_with_account_id bigint NOT NULL,
    total_color_pages integer NOT NULL,
    color_pages_estimated character(1) COLLATE pg_catalog."default" NOT NULL,
    job_type character varying(10) COLLATE pg_catalog."default",
    invoiced character(1) COLLATE pg_catalog."default" NOT NULL,
    job_comment character varying(255) COLLATE pg_catalog."default",
    protocol character varying(20) COLLATE pg_catalog."default",
    original_usage_cost double precision NOT NULL,
    refund_status character varying(6) COLLATE pg_catalog."default" NOT NULL,
    refund_request_id bigint,
    replayed character(1) COLLATE pg_catalog."default" NOT NULL,
    signature character varying(50) COLLATE pg_catalog."default",
    hardware_check_status character varying(6) COLLATE pg_catalog."default" NOT NULL,
    hardware_check_id bigint,
    job_uid character varying(40) COLLATE pg_catalog."default",
    archive_path character varying(30) COLLATE pg_catalog."default",
    duplex_pages integer NOT NULL,
    offline_usage character(1) COLLATE pg_catalog."default" NOT NULL,
    print_queue_id bigint,
    scan_action_id bigint,
    CONSTRAINT tbl_printer_usage_log_pkey PRIMARY KEY (printer_usage_log_id),
    CONSTRAINT fk_printer_usage_log_account FOREIGN KEY (charged_to_account_id)
        REFERENCES public.tbl_account (account_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_printer_usage_log_assoc_account FOREIGN KEY (assoc_with_account_id)
        REFERENCES public.tbl_account (account_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_printer_usage_log_hw_check FOREIGN KEY (hardware_check_id)
        REFERENCES public.tbl_print_hardware_check (print_hardware_check_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_printer_usage_log_ornl_pri FOREIGN KEY (original_printer_id)
        REFERENCES public.tbl_printer (printer_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_printer_usage_log_print_queue FOREIGN KEY (print_queue_id)
        REFERENCES public.tbl_printer (printer_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_printer_usage_log_printer FOREIGN KEY (printer_id)
        REFERENCES public.tbl_printer (printer_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_printer_usage_log_ref_req FOREIGN KEY (refund_request_id)
        REFERENCES public.tbl_refund_request (refund_request_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_printer_usage_log_user FOREIGN KEY (used_by_user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_print_hw_check_status;

CREATE INDEX IF NOT EXISTS ix_print_hw_check_status
    ON public.tbl_printer_usage_log USING btree
    (hardware_check_status COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_account

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_account;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_account
    ON public.tbl_printer_usage_log USING btree
    (charged_to_account_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_assoc_account

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_assoc_account;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_assoc_account
    ON public.tbl_printer_usage_log USING btree
    (assoc_with_account_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_date

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_date;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_date
    ON public.tbl_printer_usage_log USING btree
    (usage_date ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_hw_check

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_hw_check;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_hw_check
    ON public.tbl_printer_usage_log USING btree
    (hardware_check_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_job_id

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_job_id;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_job_id
    ON public.tbl_printer_usage_log USING btree
    (job_id COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_job_uid

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_job_uid;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_job_uid
    ON public.tbl_printer_usage_log USING btree
    (job_uid COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_print_queue

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_print_queue;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_print_queue
    ON public.tbl_printer_usage_log USING btree
    (print_queue_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_printer

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_printer;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_printer
    ON public.tbl_printer_usage_log USING btree
    (printer_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_ref_req

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_ref_req;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_ref_req
    ON public.tbl_printer_usage_log USING btree
    (refund_request_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_signature

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_signature;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_signature
    ON public.tbl_printer_usage_log USING btree
    (signature COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_printer_usage_log_user

-- DROP INDEX IF EXISTS public.ix_printer_usage_log_user;

CREATE INDEX IF NOT EXISTS ix_printer_usage_log_user
    ON public.tbl_printer_usage_log USING btree
    (used_by_user_id ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_net_usage_log

-- DROP TABLE IF EXISTS public.tbl_net_usage_log;

CREATE TABLE IF NOT EXISTS public.tbl_net_usage_log
(
    net_usage_log_id bigint NOT NULL,
    usage_date timestamp without time zone NOT NULL,
    usage_day timestamp without time zone NOT NULL,
    used_by_user_id bigint NOT NULL,
    usage_cost double precision NOT NULL,
    hours_used double precision NOT NULL,
    megabytes_received double precision NOT NULL,
    megabytes_sent double precision NOT NULL,
    cached_megabytes_received double precision NOT NULL,
    CONSTRAINT tbl_net_usage_log_pkey PRIMARY KEY (net_usage_log_id),
    CONSTRAINT fk_net_usage_log_user FOREIGN KEY (used_by_user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_net_usage_log_date;

CREATE INDEX IF NOT EXISTS ix_net_usage_log_date
    ON public.tbl_net_usage_log USING btree
    (usage_date ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_net_usage_log_day

-- DROP INDEX IF EXISTS public.ix_net_usage_log_day;

CREATE INDEX IF NOT EXISTS ix_net_usage_log_day
    ON public.tbl_net_usage_log USING btree
    (usage_day ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_net_usage_log_user

-- DROP INDEX IF EXISTS public.ix_net_usage_log_user;

CREATE INDEX IF NOT EXISTS ix_net_usage_log_user
    ON public.tbl_net_usage_log USING btree
    (used_by_user_id ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_application_log

-- DROP TABLE IF EXISTS public.tbl_application_log;

CREATE TABLE IF NOT EXISTS public.tbl_application_log
(
    application_log_id bigint NOT NULL,
    log_date timestamp without time zone NOT NULL,
    server_name character varying(255) COLLATE pg_catalog."default",
    log_level character varying(20) COLLATE pg_catalog."default" NOT NULL,
    message character varying(2000) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_application_log_pkey PRIMARY KEY (application_log_id)
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_application_log_date;

CREATE INDEX IF NOT EXISTS ix_application_log_date
    ON public.tbl_application_log USING btree
    (log_date ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_application_log_level

-- DROP INDEX IF EXISTS public.ix_application_log_level;

CREATE INDEX IF NOT EXISTS ix_application_log_level
    ON public.tbl_application_log USING btree
    (log_level COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_application_property

-- DROP TABLE IF EXISTS public.tbl_application_property;

CREATE TABLE IF NOT EXISTS public.tbl_application_property
(
    property_name character varying(190) COLLATE pg_catalog."default" NOT NULL,
    property_value character varying(4000) COLLATE pg_catalog."default"
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.idx_property_name;

CREATE INDEX IF NOT EXISTS idx_property_name
    ON public.tbl_application_property USING btree
    (property_name COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_config

-- DROP TABLE IF EXISTS public.tbl_config;

CREATE TABLE IF NOT EXISTS public.tbl_config
(
    property_name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    property_value character varying(1000) COLLATE pg_catalog."default",
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    propagate character(1) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_config_pkey PRIMARY KEY (property_name)
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_config_modified;

CREATE INDEX IF NOT EXISTS ix_config_modified
    ON public.tbl_config USING btree
    (modified_ticks ASC NULLS LAST, propagate COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_databasechangelog

-- DROP TABLE IF EXISTS public.tbl_databasechangelog;

CREATE TABLE IF NOT EXISTS public.tbl_databasechangelog
(
    id character varying(255) COLLATE pg_catalog."default" NOT NULL,
    author character varying(255) COLLATE pg_catalog."default" NOT NULL,
    filename character varying(255) COLLATE pg_catalog."default" NOT NULL,
    dateexecuted timestamp without time zone NOT NULL,
    orderexecuted integer NOT NULL,
    exectype character varying(10) COLLATE pg_catalog."default" NOT NULL,
    md5sum character varying(35) COLLATE pg_catalog."default",
    description character varying(255) COLLATE pg_catalog."default",
    comments character varying(255) COLLATE pg_catalog."default",
    tag character varying(255) COLLATE pg_catalog."default",
    liquibase character varying(20) COLLATE pg_catalog."default",
    contexts character varying(255) COLLATE pg_catalog."default",
    labels character varying(255) COLLATE pg_catalog."default",
    deployment_id character varying(10) COLLATE pg_catalog."default"
)

TABLESPACE pg_default;


-- Table: public.tbl_databasechangeloglock

-- DROP TABLE IF EXISTS public.tbl_databasechangeloglock;

CREATE TABLE IF NOT EXISTS public.tbl_databasechangeloglock
(
    id integer NOT NULL,
    locked boolean NOT NULL,
    lockgranted timestamp without time zone,
    lockedby character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT tbl_databasechangeloglock_pkey PRIMARY KEY (id)
)

TABLESPACE pg_default;


-- Table: public.tbl_dept_info

-- DROP TABLE IF EXISTS public.tbl_dept_info;

CREATE TABLE IF NOT EXISTS public.tbl_dept_info
(
    dept_id character varying(36) COLLATE pg_catalog."default" NOT NULL DEFAULT uuid_generate_v4(),
    dept_name character varying(255) COLLATE pg_catalog."default",
    security_group_name character varying(255) COLLATE pg_catalog."default" DEFAULT ''::character varying,
    CONSTRAINT tbl_dept_info_pkey PRIMARY KEY (dept_id)
)

TABLESPACE pg_default;


-- Table: public.tbl_ha_active_server

-- DROP TABLE IF EXISTS public.tbl_ha_active_server;

CREATE TABLE IF NOT EXISTS public.tbl_ha_active_server
(
    active character varying(256) COLLATE pg_catalog."default",
    last_update timestamp without time zone
)

TABLESPACE pg_default;

-- Table: public.tbl_notification_settings

-- DROP TABLE IF EXISTS public.tbl_notification_settings;

CREATE TABLE IF NOT EXISTS public.tbl_notification_settings
(
    id bigint NOT NULL,
    type_name character varying(64) COLLATE pg_catalog."default" NOT NULL,
    message_template character varying(1000) COLLATE pg_catalog."default",
    threshold integer,
    max_age_days integer,
    only_send_if_new character(1) COLLATE pg_catalog."default",
    schedule_type character varying(8) COLLATE pg_catalog."default",
    enabled character(1) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_notification_settings_pkey PRIMARY KEY (id),
    CONSTRAINT uk_type_name UNIQUE (type_name)
)

TABLESPACE pg_default;

-- Table: public.tbl_notification_subscription

-- DROP TABLE IF EXISTS public.tbl_notification_subscription;

CREATE TABLE IF NOT EXISTS public.tbl_notification_subscription
(
    id bigint NOT NULL,
    notification_settings_id bigint NOT NULL,
    printer_group_id bigint,
    CONSTRAINT tbl_notification_subscription_pkey PRIMARY KEY (id),
    CONSTRAINT uk_subscription_group_setting UNIQUE (notification_settings_id, printer_group_id),
    CONSTRAINT fk_subscription_printer_group FOREIGN KEY (printer_group_id)
        REFERENCES public.tbl_printer_group (printer_group_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_subscription_settings FOREIGN KEY (notification_settings_id)
        REFERENCES public.tbl_notification_settings (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_subscription_settings;

CREATE INDEX IF NOT EXISTS ix_subscription_settings
    ON public.tbl_notification_subscription USING btree
    (notification_settings_id ASC NULLS LAST)
    TABLESPACE pg_default;

	-- Table: public.tbl_notification_subscriber

-- DROP TABLE IF EXISTS public.tbl_notification_subscriber;

CREATE TABLE IF NOT EXISTS public.tbl_notification_subscriber
(
    subscription_id bigint NOT NULL,
    email character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_notification_subscriber_pkey PRIMARY KEY (subscription_id, email),
    CONSTRAINT fk_subscriber_subscription FOREIGN KEY (subscription_id)
        REFERENCES public.tbl_notification_subscription (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_subscriber_subscription;

CREATE INDEX IF NOT EXISTS ix_subscriber_subscription
    ON public.tbl_notification_subscriber USING btree
    (subscription_id ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_scan_action

-- DROP TABLE IF EXISTS public.tbl_scan_action;

CREATE TABLE IF NOT EXISTS public.tbl_scan_action
(
    scan_action_id bigint NOT NULL,
    action_type character varying(20) COLLATE pg_catalog."default" NOT NULL,
    label character varying(255) COLLATE pg_catalog."default" NOT NULL,
    target character varying(1000) COLLATE pg_catalog."default" NOT NULL,
    deleted character(1) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    deleted_date timestamp without time zone,
    CONSTRAINT tbl_scan_action_pkey PRIMARY KEY (scan_action_id)
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_scan_action_modified;

CREATE INDEX IF NOT EXISTS ix_scan_action_modified
    ON public.tbl_scan_action USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;


-- Table: public.tbl_scan_action_attribute

-- DROP TABLE IF EXISTS public.tbl_scan_action_attribute;

CREATE TABLE IF NOT EXISTS public.tbl_scan_action_attribute
(
    scan_action_id bigint NOT NULL,
    attrib_value character varying(1000) COLLATE pg_catalog."default",
    modified_ticks bigint NOT NULL,
    propagate character(1) COLLATE pg_catalog."default" NOT NULL,
    attrib_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_scan_action_attribute_pkey PRIMARY KEY (scan_action_id, attrib_name),
    CONSTRAINT fk_scan_action_attribute FOREIGN KEY (scan_action_id)
        REFERENCES public.tbl_scan_action (scan_action_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_scan_action_attr_modified;

CREATE INDEX IF NOT EXISTS ix_scan_action_attr_modified
    ON public.tbl_scan_action_attribute USING btree
    (modified_ticks ASC NULLS LAST, propagate COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;



-- Table: public.tbl_scan_action_group ------------------------------------------

-- DROP TABLE IF EXISTS public.tbl_scan_action_group;

CREATE TABLE IF NOT EXISTS public.tbl_scan_action_group
(
    scan_action_group_id bigint NOT NULL,
    group_id bigint NOT NULL,
    scan_action_id bigint NOT NULL,
    modified_ticks bigint NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_scan_action_group_pkey PRIMARY KEY (scan_action_group_id),
    CONSTRAINT fk_scan_action_group_group FOREIGN KEY (group_id)
        REFERENCES public.tbl_group (group_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_scan_action_group_scan_action FOREIGN KEY (scan_action_id)
        REFERENCES public.tbl_scan_action (scan_action_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- DROP INDEX IF EXISTS public.ix_scan_action_group_group;

CREATE INDEX IF NOT EXISTS ix_scan_action_group_group
    ON public.tbl_scan_action_group USING btree
    (group_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_scan_action_group_modified

-- DROP INDEX IF EXISTS public.ix_scan_action_group_modified;

CREATE INDEX IF NOT EXISTS ix_scan_action_group_modified
    ON public.tbl_scan_action_group USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_scan_action_group_sa

-- DROP INDEX IF EXISTS public.ix_scan_action_group_sa;

CREATE INDEX IF NOT EXISTS ix_scan_action_group_sa
    ON public.tbl_scan_action_group USING btree
    (scan_action_id ASC NULLS LAST)
    TABLESPACE pg_default;



-- Table: public.tbl_scan_action_user ------------------------------------------

-- DROP TABLE IF EXISTS public.tbl_scan_action_user;

CREATE TABLE IF NOT EXISTS public.tbl_scan_action_user
(
    scan_action_user_id bigint NOT NULL,
    user_id bigint NOT NULL,
    scan_action_id bigint NOT NULL,
    modified_ticks bigint NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT tbl_scan_action_user_pkey PRIMARY KEY (scan_action_user_id),
    CONSTRAINT fk_scan_action_user_scan_action FOREIGN KEY (scan_action_id)
        REFERENCES public.tbl_scan_action (scan_action_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_scan_action_user_user FOREIGN KEY (user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_scan_action_user_modified;

CREATE INDEX IF NOT EXISTS ix_scan_action_user_modified
    ON public.tbl_scan_action_user USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_scan_action_user_sa

-- DROP INDEX IF EXISTS public.ix_scan_action_user_sa;

CREATE INDEX IF NOT EXISTS ix_scan_action_user_sa
    ON public.tbl_scan_action_user USING btree
    (scan_action_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_scan_action_user_user

-- DROP INDEX IF EXISTS public.ix_scan_action_user_user;

CREATE INDEX IF NOT EXISTS ix_scan_action_user_user
    ON public.tbl_scan_action_user USING btree
    (user_id ASC NULLS LAST)
    TABLESPACE pg_default;



-- Table: public.tbl_scheduled_report ------------------------------------------

-- DROP TABLE IF EXISTS public.tbl_scheduled_report;

CREATE TABLE IF NOT EXISTS public.tbl_scheduled_report
(
    scheduled_report_id bigint NOT NULL,
    report_identifier character varying(200) COLLATE pg_catalog."default" NOT NULL,
    title character varying(100) COLLATE pg_catalog."default",
    data_params character varying(2000) COLLATE pg_catalog."default",
    schedule_period character varying(30) COLLATE pg_catalog."default" NOT NULL,
    export_type character varying(30) COLLATE pg_catalog."default" NOT NULL,
    recipients character varying(1000) COLLATE pg_catalog."default",
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    delivery_method character varying(50) COLLATE pg_catalog."default" NOT NULL,
    append_datestamp character(1) COLLATE pg_catalog."default" NOT NULL,
    file_name character varying(100) COLLATE pg_catalog."default",
    centralized character(1) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    custom_report_identifier character varying(200) COLLATE pg_catalog."default",
    locale character varying(16) COLLATE pg_catalog."default",
    CONSTRAINT tbl_scheduled_report_pkey PRIMARY KEY (scheduled_report_id)
)

TABLESPACE pg_default;


-- DROP INDEX IF EXISTS public.ix_scheduled_report_modified;

CREATE INDEX IF NOT EXISTS ix_scheduled_report_modified
    ON public.tbl_scheduled_report USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;



-- Table: public.tbl_sequences ------------------------------------------

-- DROP TABLE IF EXISTS public.tbl_sequences;

CREATE TABLE IF NOT EXISTS public.tbl_sequences
(
    sequence_name character varying(255) COLLATE pg_catalog."default",
    sequence_next_hi_value integer
)

TABLESPACE pg_default;

-- Table: public.tbl_server ------------------------------------------

-- DROP TABLE IF EXISTS public.tbl_server;

CREATE TABLE IF NOT EXISTS public.tbl_server
(
    server_id bigint NOT NULL,
    uuid character varying(255) COLLATE pg_catalog."default" NOT NULL,
    enabled character(1) COLLATE pg_catalog."default" NOT NULL,
    deleted character(1) COLLATE pg_catalog."default" NOT NULL,
    deleted_date timestamp without time zone,
    server_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    server_type character varying(10) COLLATE pg_catalog."default" NOT NULL,
    server_state character varying(20) COLLATE pg_catalog."default" NOT NULL,
    location character varying(200) COLLATE pg_catalog."default",
    notes character varying(2000) COLLATE pg_catalog."default",
    major_version integer NOT NULL,
    minor_version integer NOT NULL,
    build_id character varying(20) COLLATE pg_catalog."default" NOT NULL,
    sync_ticks bigint NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    display_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    network_address character varying(255) COLLATE pg_catalog."default",
    patch_version bigint,
    CONSTRAINT tbl_server_pkey PRIMARY KEY (server_id)
)

TABLESPACE pg_default;

-- Index: ix_server_modified

-- DROP INDEX IF EXISTS public.ix_server_modified;

CREATE INDEX IF NOT EXISTS ix_server_modified
    ON public.tbl_server USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;



-- Table: public.tbl_topup_card ------------------------------------------

-- DROP TABLE IF EXISTS public.tbl_topup_card;

CREATE TABLE IF NOT EXISTS public.tbl_topup_card
(
    topup_card_id bigint NOT NULL,
    batch_id character varying(255) COLLATE pg_catalog."default" NOT NULL,
    card_number character varying(255) COLLATE pg_catalog."default" NOT NULL,
    date_used timestamp without time zone,
    date_loaded timestamp without time zone NOT NULL,
    expiry_date timestamp without time zone NOT NULL,
    value double precision NOT NULL,
    used_by_user_id bigint,
    CONSTRAINT tbl_topup_card_pkey PRIMARY KEY (topup_card_id),
    CONSTRAINT fk_topup_card_user FOREIGN KEY (used_by_user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- Index: ix_topup_card_batch_id

-- DROP INDEX IF EXISTS public.ix_topup_card_batch_id;

CREATE INDEX IF NOT EXISTS ix_topup_card_batch_id
    ON public.tbl_topup_card USING btree
    (batch_id COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_topup_card_number

-- DROP INDEX IF EXISTS public.ix_topup_card_number;

CREATE INDEX IF NOT EXISTS ix_topup_card_number
    ON public.tbl_topup_card USING btree
    (card_number COLLATE pg_catalog."default" ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_topup_card_user

-- DROP INDEX IF EXISTS public.ix_topup_card_user;

CREATE INDEX IF NOT EXISTS ix_topup_card_user
    ON public.tbl_topup_card USING btree
    (used_by_user_id ASC NULLS LAST)
    TABLESPACE pg_default;



-- Table: public.tbl_user_account ------------------------------------------

-- DROP TABLE IF EXISTS public.tbl_user_account;

CREATE TABLE IF NOT EXISTS public.tbl_user_account
(
    user_account_id bigint NOT NULL,
    user_id bigint NOT NULL,
    account_id bigint NOT NULL,
    created_date timestamp without time zone NOT NULL,
    created_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_date timestamp without time zone NOT NULL,
    modified_by character varying(255) COLLATE pg_catalog."default" NOT NULL,
    modified_ticks bigint NOT NULL,
    CONSTRAINT tbl_user_account_pkey PRIMARY KEY (user_account_id),
    CONSTRAINT fk_user_account_account FOREIGN KEY (account_id)
        REFERENCES public.tbl_account (account_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_user_account_user FOREIGN KEY (user_id)
        REFERENCES public.tbl_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

-- Index: ix_user_account_account

-- DROP INDEX IF EXISTS public.ix_user_account_account;

CREATE INDEX IF NOT EXISTS ix_user_account_account
    ON public.tbl_user_account USING btree
    (account_id ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_account_modified

-- DROP INDEX IF EXISTS public.ix_user_account_modified;

CREATE INDEX IF NOT EXISTS ix_user_account_modified
    ON public.tbl_user_account USING btree
    (modified_ticks ASC NULLS LAST)
    TABLESPACE pg_default;
-- Index: ix_user_account_user

-- DROP INDEX IF EXISTS public.ix_user_account_user;

CREATE INDEX IF NOT EXISTS ix_user_account_user
    ON public.tbl_user_account USING btree
    (user_id ASC NULLS LAST)
    TABLESPACE pg_default;


DROP TABLE IF EXISTS public.tbl_user_account_temp;

CREATE TABLE tbl_user_account_temp (
 user_account_id  varchar(255) ,
    user_id varchar(255),
    account_id varchar(255),
    created_date varchar(255),
    created_by varchar(255),
    modified_date varchar(255),
    modified_by varchar(255),
    modified_ticks varchar(255)
);

COPY tbl_user_account_temp (
    user_account_id,
	user_id ,
    account_id ,
    created_date ,
    created_by ,
    modified_date ,
    modified_by ,
    modified_ticks 
) FROM 'c:\path_to_db\tbl_user_account_20250123.csv' csv;

delete from tbl_user_account_temp t
where t.user_id = 'user_id';

INSERT INTO tbl_user_account (
    user_account_id,
		user_id ,
    account_id ,
    created_date ,
    created_by ,
    modified_date ,
    modified_by ,
    modified_ticks 
)
SELECT 
user_account_id::bigint,
	user_id ::bigint,
    account_id ::bigint,
    created_date ::timestamp,
    created_by ,
    modified_date ::timestamp,
    modified_by ,
    modified_ticks ::bigint
FROM tbl_user_account_temp;

DROP TABLE IF EXISTS tbl_user_account_temp;

-- uuid  
-- CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

drop table IF EXISTS tbl_printer_info;

CREATE TABLE IF NOT EXISTS public.tbl_printer_info
(
    printer_id varchar(36) NOT NULL default uuid_generate_v4(),
    server_name varchar(255) ,
    printer_name varchar(255) NOT NULL,
    display_name varchar(510),
    location varchar(255) ,
    notes varchar(2000),
    charge_type varchar(20) ,
    default_cost double precision ,
    deleted varchar(1)  ,
    deleted_date timestamp without time zone,
    disabled varchar(1) ,
    disabled_until timestamp without time zone,
    total_jobs integer ,
    total_pages integer ,
    total_sheets integer ,
    reset_by varchar(255),
    reset_date timestamp without time zone,
    created_date timestamp without time zone ,
    created_by varchar(255)  ,
    modified_date timestamp without time zone ,
    modified_by varchar(255)  ,
    color_detection_mode varchar(20)  ,
    device_type varchar(100) ,
    ext_device_function varchar(30) ,
    physical_printer_id varchar(100),
    printer_type varchar(200) ,
    serial_number varchar(100) ,
    web_print_enabled varchar(1)  ,
    custom1 varchar(50),
    custom2 varchar(50),
    custom3 varchar(50),
    custom4 varchar(50),
    custom5 varchar(50),
    custom6 varchar(50),
    last_usage_date timestamp without time zone,
    gcp_printer_id varchar(100) ,
    gcp_enabled varchar(1) ,
    modified_ticks bigint ,
    server_uuid varchar(255) ,
    parent_id bigint
)
TABLESPACE pg_default;

insert into tbl_printer_info
select * from tbl_printer;

